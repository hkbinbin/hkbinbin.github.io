<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Format String on hkbinçš„å°åšå®¢~</title><link>https://hkbinbin.github.io/tags/format-string/</link><description>Recent content in Format String on hkbinçš„å°åšå®¢~</description><generator>Hugo -- gohugo.io</generator><language>zh-Hans</language><lastBuildDate>Mon, 28 Apr 2025 22:06:57 +0800</lastBuildDate><atom:link href="https://hkbinbin.github.io/tags/format-string/index.xml" rel="self" type="application/rss+xml"/><item><title>Blind Pwnçš„ä¸€äº›æ€è€ƒ</title><link>https://hkbinbin.github.io/p/blind-pwn%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83/</link><pubDate>Mon, 28 Apr 2025 22:06:57 +0800</pubDate><guid>https://hkbinbin.github.io/p/blind-pwn%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83/</guid><description>&lt;h1 id="blind-pwnçš„ä¸€äº›æ€è€ƒ">&lt;a href="#blind-pwn%e7%9a%84%e4%b8%80%e4%ba%9b%e6%80%9d%e8%80%83" class="header-anchor">&lt;/a>Blind Pwnçš„ä¸€äº›æ€è€ƒ
&lt;/h1>&lt;h2 id="é—²èŠ">&lt;a href="#%e9%97%b2%e8%81%8a" class="header-anchor">&lt;/a>é—²èŠ
&lt;/h2>&lt;p>2025å¹´é•¿åŸæ¯å†³èµ›æ¸—é€å‡ºç°äº†ä¸€ä¸ªpwnæœåŠ¡ï¼Œç„¶è€Œå¹¶æ²¡æœ‰é™„ä»¶ï¼Œç»è¿‡æµ‹è¯•å‘ç°æ˜¯format stringç±»å‹çš„æ¼æ´ï¼Œä¸ç¦æƒ³èµ·Blind Pwnï¼Œä½†æ˜¯æ‰“çš„åˆå°‘ï¼Œå¯¼è‡´æµªè´¹äº†å¥½å‡ ä¸ªå°æ—¶â€¦&lt;/p>
&lt;p>æœŸé—´å¯¹åˆ©ç”¨çš„ä¸€äº›æ€è€ƒï¼Œå€Ÿæ­¤æœºä¼šè®°å½•ä¸€ä¸‹&lt;/p>
&lt;h2 id="é—®é¢˜çš„å…³é”®">&lt;a href="#%e9%97%ae%e9%a2%98%e7%9a%84%e5%85%b3%e9%94%ae" class="header-anchor">&lt;/a>é—®é¢˜çš„å…³é”®
&lt;/h2>&lt;p>é—®é¢˜çš„å…³é”®æ˜¯æ— ä»»ä½•æœ‰æ•ˆä¿¡æ¯ï¼Œå³ä½¿æ ˆæº¢å‡ºä¹Ÿä¸çŸ¥é“åº”è¯¥è·³è½¬åˆ°å“ªé‡Œ&lt;/p>
&lt;p>å¯¹æ­¤æœ‰ä¸¤ç§æ€è·¯&lt;/p>
&lt;ol>
&lt;li>çˆ†ç ´åœ°å€è§‚å¯Ÿç¨‹åºç›¸åº”æƒ…å†µï¼Œæ¥åˆ¤æ–­æ˜¯å¦è¿›å…¥äº†æŸäº›å‡½æ•°ï¼ˆå¦‚è¾“å‡ºå‡½æ•°ï¼Œmainå‡½æ•°ç­‰ï¼‰ï¼Œè¿™ç§å¯¹åº”çš„æ‰‹æ³•åº”è¯¥æ˜¯BROPï¼ˆåˆ©ç”¨æ¡ä»¶ä¸ºçº¯æ ˆæº¢å‡ºï¼ŒNO PIEï¼‰&lt;/li>
&lt;li>é€šè¿‡fmtæ¼æ´ç›´æ¥leak elfæ•°æ®ï¼ˆ%s-%pç­‰æ¥ç¡®è®¤ï¼‰ï¼Œè¿™ç§æ‰‹æ³•åˆ©ç”¨æ¡ä»¶ä¸ºformat stringæ¼æ´&lt;/li>
&lt;/ol>
&lt;p>æ— è®ºæ˜¯å“ªç§æ€è·¯ï¼Œç¬¬ä¸€å¤§æ­¥çš„ç›®çš„å°±æ˜¯å¯»æ‰¾åˆ°puts/printf/writeè¿™äº›å‡½æ•°ï¼Œè¿›ä¸€æ­¥æ³„éœ²æ•´ä¸ªelfï¼Œå½“è¿™ä¸€æ­¥å®Œæˆçš„æ—¶å€™ï¼Œå°±å’Œæ™®é€špwnæ²¡æœ‰åŒºåˆ«äº†&lt;/p>
&lt;h2 id="brop">&lt;a href="#brop" class="header-anchor">&lt;/a>BROP
&lt;/h2>&lt;p>è¿™ç§æ‰‹æ³•éœ€è¦å¤§é‡å°è¯•/çˆ†ç ´ï¼Œåˆ©ç”¨æ¡ä»¶ä¸ºæ ˆæº¢å‡º/NO PIEï¼Œåœ¨æ²¡æœ‰PIEä¿æŠ¤çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ç¨‹åºçš„elf baseï¼Œç„¶ååœ¨æŒŸæŒæ‰§è¡Œæµçš„æ—¶å€™ï¼Œå°†è¿”å›åœ°å€éå†æŒŸæŒæ•´ä¸ªelfä»£ç æ®µçš„æ¯ä¸ªåœ°å€ï¼Œå¯»æ‰¾å¯¹åº”gadgets&lt;/p>
&lt;h3 id="stopping-gadgets">&lt;a href="#stopping-gadgets" class="header-anchor">&lt;/a>Stopping gadgets
&lt;/h3>&lt;p>Stopping gadgetsæŒ‡çš„æ˜¯è®©ç¨‹åºå¡ä½ä½†ä¸å´©æºƒçš„gadgetï¼Œæ¯”å¦‚main/_startï¼Œè¿™å‡ ä¸ªå‡½æ•°çš„åœ°å€ï¼Œå®ƒä¼šè®©ç¨‹åºé‡å¯ï¼Œä½†ä¸ä¼šæ–­å¼€socketé“¾æ¥ï¼Œé€šè¿‡è¿™ä¸€ç°è±¡å°±å¯ä»¥åˆ¤æ–­æ˜¯å¦æ‹¿åˆ°Stopping gadgetsã€‚&lt;/p>
&lt;p>Stopping gadgetsä¼šä¸ºä¸‹ä¸€æ­¥æ‹¿åˆ°å…¶ä»–gadgetsä½œä¸ºä¸€ä¸ªä¾é &lt;/p>
&lt;h3 id="register-gadgets">&lt;a href="#register-gadgets" class="header-anchor">&lt;/a>register gadgets
&lt;/h3>&lt;p>ä¸‹ä¸€æ­¥å¯»æ‰¾register gadgetsï¼Œè¿™ä¸€æ­¥ä¸ç¡®å®šæ€§æŒºå¤§çš„&lt;/p>
&lt;p>å¦‚éœ€è¦å¯»æ‰¾&lt;code>pop rdi; ret&lt;/code> è¿™ä¸ªgadgetï¼Œå°†payloadè®¾ç½®ä¸º&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">flat&lt;/span>&lt;span class="p">([&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">padding&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pop_rdi&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Stopping&lt;/span> &lt;span class="n">gadget&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™ä¸ªpayloadä¼šå°†è®¾pop_rdiçš„åœ°å€æ»¡è¶³å®ƒæ˜¯ä¸€ä¸ª&lt;code>pop xxx ; ret&lt;/code> ç»“æ„ï¼Œç„¶åä¸èƒ½å½±å“åé¢è¿›å…¥Stopping gadget&lt;/p>
&lt;p>æ‰€ä»¥ä¾èµ–è¿™ä¸ªStopping gadgetï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ç¨‹åºå¦‚æœæŒ‚äº†ï¼Œé‚£å°±è¿™ä¸ªåœ°å€ä¸æ»¡è¶³ï¼Œå¦åˆ™åº”è¯¥æ˜¯æ»¡è¶³è¿™ä¸ªç»“æ„çš„&lt;/p>
&lt;h3 id="leak-functions">&lt;a href="#leak-functions" class="header-anchor">&lt;/a>leak functions
&lt;/h3>&lt;p>æ¥ä¸‹æ¥ä¸‹ä¸€æ­¥éœ€è¦å¯»æ‰¾èƒ½å¤Ÿè¾“å‡ºçš„å‡½æ•°ï¼Œæ¯”å¦‚&lt;code>puts&lt;/code> /&lt;code>printf&lt;/code> /&lt;code>write&lt;/code> è¿™å‡ ä¸ªï¼Œè¿™ä¸€æ­¥åŒæ ·ä¾èµ–äºä¸Šé¢çš„register gadgetsä»¥åŠStopping gadgets&lt;/p>
&lt;p>æ„é€ payloadå¦‚&lt;/p>
&lt;p>&lt;code>puts&lt;/code> /&lt;code>printf&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">flat&lt;/span>&lt;span class="p">([&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">padding&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pop_rdi&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">xxx&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts_addr&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Stopping&lt;/span> &lt;span class="n">gadget&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œçš„puts_addréœ€è¦éå†æ•´ä¸ªä»£ç æ®µï¼Œpop_rdiæœ‰å¤šç§æƒ…å†µï¼Œå–å†³äºå¾—åˆ°æ»¡è¶³çš„register gadgetsæ•°é‡ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥éœ€è¦çˆ†ç ´çš„æ›´å¤š&lt;/p>
&lt;p>è¿™é‡Œxxxå¡«ä»€ä¹ˆå‘¢ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ELFç¨‹åºæœ‰ä¸ªheaderï¼Œé‡Œé¢çš„å€¼æ˜¯\x7fELFå¼€å¤´çš„&lt;/p>
&lt;p>æ‰€ä»¥æŠŠxxxå¡«ä¸º&lt;code>0x400000&lt;/code> å³å¯&lt;/p>
&lt;p>å¦‚æœæˆåŠŸæ‰¾åˆ°ï¼Œé‚£ä¹ˆå°±ä¼šè¾“å‡º\x7fELF&lt;/p>
&lt;p>&lt;code>write&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">flat&lt;/span>&lt;span class="p">([&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">padding&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pop_rdi&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pop_rsi&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">xxx&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pop_rdx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x50&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puts_addr&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Stopping&lt;/span> &lt;span class="n">gadget&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä½¿ç”¨writeè¾“å‡ºå°±ä¼šæ›´åŠ å¤æ‚ï¼Œå› ä¸ºéœ€è¦çˆ†ç ´çš„æ¬¡æ•°å˜æˆäº†puts_addrå¯èƒ½å€¼ * register gadgetsæ•°é‡^3&lt;/p>
&lt;p>ç†è®ºå¯è¡Œï¼Œä½†å®é™…ä¸Šä¼°è®¡å¾ˆéš¾çˆ†å‡ºæ¥&lt;/p>
&lt;h3 id="leak-elf">&lt;a href="#leak-elf" class="header-anchor">&lt;/a>Leak ELF
&lt;/h3>&lt;p>å½“ä¸Šé¢çš„ä¸‰ç§gadgetså…¨éƒ¨æ‰¾åˆ°ä¹‹åï¼Œæˆ‘ä»¬å°±èƒ½ç¡®å®šä¸€æ•´æ¡leaké“¾äº†ï¼Œé€šè¿‡æŒŸæŒæ‰§è¡Œæµä¸»åŠ¨è°ƒç”¨è¿™æ¡åˆ©ç”¨é“¾å°±å¯ä»¥æŠŠæ•´ä¸ªELF dumpä¸‹æ¥ï¼Œåé¢å°±ä¸æ˜¯ä»€ä¹ˆéš¾äº‹äº†&lt;/p>
&lt;h2 id="format-string-in-blind-pwn">&lt;a href="#format-string-in-blind-pwn" class="header-anchor">&lt;/a>Format String in Blind Pwn
&lt;/h2>&lt;p>è¿™ç§æƒ…å†µä¸‹ä¼šç›¸å¯¹äºBROPæ›´åŠ ç®€å•(å—?)&lt;/p>
&lt;p>fmtæ¼æ´åˆåˆ†ä¸ºæ ˆä¸Šå’Œå †ä¸Šä¸¤ç§&lt;/p>
&lt;p>å¯¹äºæ ˆä¸Šè‡ªç„¶æ˜¯å¥½åšçš„ï¼Œç›´æ¥å°±å¯ä»¥å¾€æ ˆé‡Œå¸ƒç½®elfæŒ‡é’ˆï¼Œç„¶åé€šè¿‡&lt;code>%s&lt;/code> æ¥æ³„éœ²å¯¹åº”åœ°å€ï¼Œè™½ç„¶&lt;code>\x00&lt;/code> æ— æ³•è·çŸ¥ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ— è¾“å‡ºæ¥åˆ¤æ–­&lt;/p>
&lt;p>å †ä¸Šå…¶å®ä¹Ÿå¥½åšï¼ŒåŒºåˆ«åœ¨äºéœ€è¦å…ˆé€šè¿‡&lt;code>%n&lt;/code> é“¾å­æ¥å¯¹æŒ‡é’ˆè¿›è¡Œä¿®æ”¹ï¼Œè¿™é‡Œéœ€è¦å›å¿†ä¸€ä¸‹å †ä¸Šfmt pwnæ˜¯æ€ä¹ˆåšçš„ï¼Œæœ€é€šç”¨çš„åšæ³•å°±æ˜¯åˆ©ç”¨æ ˆä¸Šç¯å¢ƒå˜é‡çš„æŒ‡é’ˆï¼Œå®ƒçš„ç»“æ„é•¿è¿™æ ·ï¼š&lt;/p>
&lt;p>&lt;code>A: Bâ†’C(&amp;quot;/home/hkbin/pwn&amp;quot;)&lt;/code>&lt;/p>
&lt;p>åœ¨Aåœ°å€ä¸Šï¼Œå­˜åœ¨BæŒ‡é’ˆï¼ŒæŒ‡å‘Cï¼ŒCçš„å†…å®¹æ˜¯ç¯å¢ƒå˜é‡&lt;/p>
&lt;p>æ­¤æ—¶é€šè¿‡&lt;code>%n&lt;/code> ç³»åˆ—çš„fmtï¼Œä¿®æ”¹Cçš„å€¼ï¼Œè®©å®ƒä¸€æ­¥æ­¥æˆä¸ºä¸€ä¸ªæ ˆåœ°å€&lt;/p>
&lt;p>æ­¤æ—¶å°±å˜æˆè¿™æ ·çš„é“¾å­&lt;/p>
&lt;p>&lt;code>A: B-&amp;gt;C-&amp;gt;D(xxx)&lt;/code>&lt;/p>
&lt;p>åç»­å³å¯é…åˆ&lt;code>A: B-&amp;gt;C&lt;/code> ä»¥åŠ&lt;code>B: C-&amp;gt;D&lt;/code> è¿™ä¸¤æ¡é“¾å­å®ç°ä»»æ„åœ°å€è¯»å†™äº†&lt;/p>
&lt;p>å¯¹äºBlind PwnåŒæ ·ä¹Ÿå¯ä»¥è¿™æ ·åšï¼Œåˆ›é€ äº†è‡ªå·±çš„&lt;code>B: C-&amp;gt;D&lt;/code> é“¾å­ä¹‹åå°±å¯ä»¥å»leak ELFäº†&lt;/p>
&lt;p>ä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œæ„é€ &lt;code>B: C-&amp;gt;D&lt;/code> é“¾å­çš„æˆæœ¬æ¯”è¾ƒé«˜ï¼Œéœ€è¦å¾ˆé•¿çš„payloadï¼Œå¹¶ä¸”å¾€å¾€éœ€è¦ä½¿ç”¨&lt;code>%lln&lt;/code> ï¼Œ1byte1byteåœ°å†™å…¥ï¼Œé€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œä¹Ÿæ¯”è¾ƒå¤æ‚&lt;/p>
&lt;h2 id="å›åˆ°é—²èŠ">&lt;a href="#%e5%9b%9e%e5%88%b0%e9%97%b2%e8%81%8a" class="header-anchor">&lt;/a>å›åˆ°é—²èŠ
&lt;/h2>&lt;p>é•¿åŸæ¯é¢˜ç›®ç¯å¢ƒæ˜¯æ ˆä¸Šçš„fmtæ¼æ´ï¼Œé‚£ä¸ºå•¥å¾ˆéš¾æ‰“å‘¢ï¼Œå› ä¸ºä»–ä¼š&lt;code>\x00&lt;/code> æˆªæ–­&lt;/p>
&lt;p>åœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬æ— æ³•éšæ„åœ°æ’å…¥ä¾‹å¦‚&lt;code>0x400000&lt;/code> è¿™æ ·çš„åœ°å€ï¼Œè¿™ä¼šå¯¼è‡´ä¸€äº›å¯¹é½åçš„å‡½æ•°æ²¡æ³•å®Œå¥½åœ°dumpä¸‹æ¥ï¼Œå¹¶ä¸”è¾“å…¥é•¿åº¦ä¹Ÿæœ‰é™ï¼Œæƒ³æ„é€ ç±»ä¼¼å †ä¸Šfmtçš„é“¾å­ä¹Ÿæ— æ³•å®Œæˆ(&lt;/p>
&lt;p>ğŸ˜­ ğŸ˜­&lt;/p></description></item></channel></rss>